---
title: "Vector Database"
description: "Give your agents documents to guide their responses"
---

## Introduction

If you have a collection of documents that you want your agent to be able to pull information from,
you can store their embeddings in a vector database. Then, each time the bot recieves a message,
it will create an embeddfing of the user message and query the vector database for the most similar
documents. These documents will be shown to the agent to guide its response to the user message.

Currently, we support [Pinecone](https://www.pinecone.io/). Under the hood, we use an approach similar
to langchain to store the documents in pinecone. Each vector in pinecone must have two pieces of metadata
to be compatible with Vocode:
    - `text`: The text that will be shown to the agent.
    - `source`: The name of the document where the text comes from. This could be the title of an article,
    for example.

## Adding Documents to Pinecone

You can manaully add documents to pinecone any way you like as long as you include the required metadata.
If you have a folder of PDFs, docx files, text files, etc. that you want to add to pinecone, you can use
the below script which uses [Unstructured](https://github.com/Unstructured-IO/unstructured) to parse
many kinds of files types, extract the text, and add it to pinecone.

The script was tested with these package versions:
```
python = "^3.10"
langchain = "^0.0.237"
spacy = "^3.6.0"
unstructured = {extras = ["local-inference"], version = "^0.8.1"}
layoutparser = {extras = ["layoutmodels", "tesseract"], version = "^0.3.4"}
pinecone-client = "^2.2.2"
openai = "^0.27.8"
torch = ">=2.0.0, !=2.0.1"
tiktoken = "^0.4.0"
```

```python
import os
import pinecone
from langchain.embeddings.openai import OpenAIEmbeddings
from langchain.text_splitter import SpacyTextSplitter
from langchain.vectorstores import Pinecone
from langchain.document_loaders import DirectoryLoader, UnstructuredFileLoader

PINECONE_API_KEY = os.environ["PINECONE_API_KEY"]
PINECONE_ENVIRONMENT = os.environ["PINECONE_ENVIRONMENT"]
OPENAI_API_KEY = os.environ["OPENAI_API_KEY"]


loader = DirectoryLoader('./docs', glob="**/*.*", show_progress=True, loader_cls=UnstructuredFileLoader)
print("Loading documents...")
documents = loader.load()
text_splitter = SpacyTextSplitter(chunk_size=1000)
print("Splitting documents...")
docs = text_splitter.split_documents(documents)

embeddings = OpenAIEmbeddings()

pinecone.init(
    api_key=PINECONE_API_KEY,
    environment=PINECONE_ENVIRONMENT,
)

index_name = "your_index_name"

print("Creating index...")
docsearch = Pinecone.from_documents(docs, embeddings, index_name=index_name)
```

## Configuring Your Agent

To add your vector database to your agent, you need to add a vector database config to your agent:

<CodeGroup>

```javascript updateAgent.js
import { VocodeClient } from '@vocode/vocode-api';

const vocode = new VocodeClient({
    token: 'baeadc4558ae060d367ed65bf0ad7914',
    environment: 'https://api.vocode.dev/'
});

async function main() {
    const agent = await vocode.agents.updateAgent(
        {
            "id": "6897c5a6-db0b-431c-a50d-913b087aa1f3",
            "body": { "vector_database": { "type": "vector_database_pinecone", "index": "my-index-98a371d", "api_key": "45dd33fa-a072-4f01-b102-d490e3d78325", "api_environment": "gcp-starter" } }
        }
    )
    console.log(agent);
}

main();
```

```python update_agent.py
from vocode import PineconeVectorDatabaseUpdateParams
from vocode.client import Vocode

vocode_client = Vocode(
    token="baeadc4558ae060d367ed65bf0ad7914", environment="https://api.vocode.dev/"
)

agent = vocode_client.agents.update_agent(
    id="6897c5a6-db0b-431c-a50d-913b087aa1f3",
    request=PineconeVectorDatabaseUpdateParams(
        type="vector_database_pinecone",
        index="my-index-98a371d",
        api_key="45dd33fa-a072-4f01-b102-d490e3d78325",
        api_environment="gcp-starter",
    ),
)
```

</CodeGroup>

Now your agent will query the vector database for each user message.